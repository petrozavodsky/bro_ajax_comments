var $=jQuery.noConflict();bro_ajax_comments={ajax_form_data:$("#commentform").serialize(),run:function(){var e=this;e.comment_submit("#commentform"),e.reply(),e.auto_reply(),$(window).on("hashchange",function(){e.auto_reply()}),e.save_in_local_storge(),
// this_class.preloader();
e.scrill_to_comment_article(),$(window).on("bro_ajax_comments_change_text_data",function(){e.set_ajax_form_data()}),$(window).on("bro_ajax_comments_beforeSubmitForm",function(){$(window).trigger("bro_ajax_comments_change_text_data")})},set_ajax_form_data:function(){var e=this;e.ajax_form_data=$("#commentform").serialize()},save_in_local_storge:function(){$("#commentform").sisyphus({customKeySuffix:"bro_ajax_comments_",locationBased:!1,excludeFields:$("#_wp_unfiltered_html_comment_disabled , #comment_post_ID , #comment_parent"),timeout:2,autoRelease:!0})},comment_submit:function(e){var t=this;t.ajax_submit("#commentform"),$(e).keydown(function(t){t.shiftKey&&13==t.keyCode&&$(e).trigger("submit")})},form_detach:function(e){var t=$("#respond").detach();return t.find("#comment_parent").val(e),t},reply:function(){var e=this;$(".comment-reply-link").on("click",function(){$(window).trigger("bro_ajax_comments_reply_before");var t=JSON.parse($(this).attr("data-reply-info")),o=t.comment_ID;$(e.form_detach(o)).appendTo("#article-comment-"+t.comment_ID),$(window).trigger("bro_ajax_comments_reply_after")})},auto_reply:function(){var e=window.location.hash;""!==e&&e.indexOf("#article-comment-")+1&&$("[href='"+e+"']").click()},ajax_submit:function(e){var t=this;$(e).find("[type='submit']").removeAttr("disabled"),$(e).hasClass("load")||$(e).submit(function(o){o.preventDefault(),$(window).trigger("bro_ajax_comments_beforeSubmitForm");var n=$(this).attr("method"),a=$(this).attr("action"),r=$(this),m=t.ajax_form_data;console.log(m),$.ajax({type:n,url:a,data:m,beforeSend:function(e,t){$(window).trigger("bro_ajax_comments_beforeSend",{data:[e,t]}),r.addClass("load"),r.find("[type='submit']").attr("disabled","disabled")},success:function(t){if(console.log(t),$(".bro_ajax_comments__exceptions-message").remove(),t.hasOwnProperty("exceptions"))t.hasOwnProperty("exception_code")?403!==t.exception_code&&200!==t.exception_code||$(window).trigger("bro_ajax_comments_error",{type:"no-login",data:[t]}):$(e).prepend(t.html_exceptions);else if(void 0!==t.html&&void 0!==t.comment){var o=t.html,n=t.comment;r.closest(".comment__article-wrap").length?$("#comment-wrap-"+n.comment_parent).after(o):$("#respond").before(o),r.trigger("reset")}$(window).trigger("bro_ajax_comments_success",t)},complete:function(e,o){if("success"===o&&void 0!==e&&!e.responseJSON.hasOwnProperty("exceptions")){var n=e.responseJSON.comment.comment_ID;$(t.form_detach(n)).appendTo("#article-comment-"+n),$(window).trigger("bro_ajax_comments_add_comment",{data:[e,o]})}$(window).trigger("bro_ajax_comments_complete",{data:[e,o]}),r.find("[type='submit']").removeAttr("disabled"),r.removeClass("load")}})})},scrill_to_comment_article:function(){$(window).on("bro_ajax_comments_complete",function(e,t){var o=t.data[0].responseJSON;if(!o.hasOwnProperty("exceptions")){var n=o.comment.comment_ID,a=$("#comment-wrap-"+n).offset().top;$.browser.safari?$("body").animate({scrollTop:a},900):$("html").animate({scrollTop:a},900)}})},preloader:function(){var e,t=$("#submit").text();$(window).on("bro_ajax_comments_beforeSend",function(){var o="";e=setInterval(function(){o+=".",$("#submit").text(t+o),o.length>=3&&(o="")},1e3)}),$(window).on("bro_ajax_comments_complete",function(){clearInterval(e),$("#submit").text(t)})}},$(document).ready(function(){bro_ajax_comments.run()});
